CXX = clang++
BIN_DIR = ../lib
BIN = $(BIN_DIR)/libthecore.a
INCLUDE = ../include

#CFLAGS = -m32 -Wall -O2 -pipe -g -I$(INCLUDE) -Wno-invalid-source-encoding
CFLAGS = -m32 -march=i686 -msse2 -g -O1 -pipe -frtti -fexceptions -pthread -D_THREAD_SAFE -fno-stack-protector -fno-strict-aliasing -I$(INCLUDE)

C_SRCS = $(wildcard *.c)
CPP_SRCS = $(wildcard *.cpp)
OBJFILES = $(C_SRCS:.c=.o) $(CPP_SRCS:.cpp=.o)

default: $(BIN)

$(BIN): $(OBJFILES)
	mkdir -p $(BIN_DIR)
	ar cru $(BIN) $(OBJFILES)
	ranlib $(BIN)

clean:
	rm -f *.o $(BIN)

%.o: %.c
	$(CXX) $(CFLAGS) -x c++ -c $< -o $@

%.o: %.cpp
	$(CXX) $(CFLAGS) -c $< -o $@
